<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<!--[if IE 8]> 				 <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
    <meta name="viewport" content="width=device-width" />
  <title>Damon McDougall's Homepage</title>
  <link rel="stylesheet" href="./theme/css/normalize.css" />
  <link rel="stylesheet" href="./theme/css/foundation.css" />
  <link rel="stylesheet" href="./theme/css/responsive-tables.css" />
  <link rel="stylesheet" href="./theme/css/app.css" />
  <link href="http://netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.css" rel="stylesheet">
  <!--<link rel="stylesheet" href="./theme/css/ipynb.css" />-->
  <script src="./theme/js/vendor/jquery.js"></script>
  <script src="./theme/js/responsive-tables.js"></script>
  <script src="./theme/js/vendor/custom.modernizr.js"></script>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="http://dmcdougall.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Damon McDougall's Homepage Full Atom Feed" />
            <link href="http://dmcdougall.github.io/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="Damon McDougall's Homepage Categories Atom Feed" />
          <link rel="icon" type="image/ico" href="favicon.ico" />
  <script language="javascript">
  <!--
  function okWWTHMfxCNVOnZ()
  {
  /* Munged addy code - YOU CAN EDIT COMMENT THIS TAG BETWEEN THE TWO STARS */
  /* SAYS "email me" */
  var SDqmhKXwoXuIYlZ=["100","97","109","x6f","x6e","64","x69","x63","x65","115","x2e","x75","116","101","x78","x61","115","x2e","x65","x64","x75"];
  var wWQTeiUCsBamNES=['?','s','u','b','j','e','c','t','=','&','c','c','=','&','b','c','c','=','&','b','o','d','y','='];
  var pcrLXnoZbnFcMrE=["101","109","97","x69","108","32","x6d","101"];
  document.write("<a href=\"&#x6d;&#x61;&#x69;&#x6c;&#x74;&#x6f;&#00058;");
    for (i=0; i<SDqmhKXwoXuIYlZ.length; i++) document.write('&#'+SDqmhKXwoXuIYlZ[i]+';');
    for (i=0; i<wWQTeiUCsBamNES.length; i++) document.write(wWQTeiUCsBamNES[i]);
    document.write('" style="" class="" id="">');
    for (i=0; i<pcrLXnoZbnFcMrE.length; i++) document.write('&#'+pcrLXnoZbnFcMrE[i]+';');
    document.write('</a>');
  /* Munged addy code - YOU CAN EDIT COMMENT THIS TAG BETWEEN THE TWO STARS */
  }
  //-->
  </script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6791969-2']);
    _gaq.push(['_trackPageview']);
    
    (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script type="text/javascript">
    function doNav(url) {
    document.location.href = url;
    }
  </script>
  </head>

<body id="index" class="home">
  <!-- Nav Bar -->
  <div class="row">
    <div class="large-12 columns">
      <h1>Damon McDougall</h1>
      <hr />
    </div>
  </div>
  <!-- End Nav -->

  <!-- Main Page Content and Sidebar -->
  <div class="row">
    <!-- Sidebar -->
    <aside class="large-1 columns">
      <ul class="side-nav">
        <li><a href="./index.html"><i class="make-grey icon-3x icon-user"></i></a></li>
        <li><a href="http://blog.dmcdougall.co.uk"><i class="make-grey icon-3x icon-pencil"></i></a></li>
        <li><a href="./feeds/blog.atom.xml"><i class="make-grey icon-3x icon-rss"></i></a></li>
        <li><a href="http://www.github.com/dmcdougall"><i class="make-grey icon-3x icon-github"></i></a></li>
      </ul>
    </aside>
    <!-- End Sidebar -->

    <!-- Main Blog Content -->
    <div class="large-11 columns" role="content">
      <div class="panel radius">
          <h2 class="entry-title">
    Publication-ready the first time: Beautiful, reproducible plots with Matplotlib
  </h2>
  <p class='date'>
    Wed 29 May 2013
  </p>
  <article>
        
    <div class="entry-content">
      <p>First things first, mad props to <a class="reference external" href="http://agentzlerich.blogspot.com/">Rhys Ulerich</a> for coming up with this title.</p>
<p>In my <a class="reference external" href="http://damon-is-a-geek.com/getting-started-with-matplotlib.html">last post</a>, I gave a very brief introduction into <a class="reference external" href="http://matplotlib.org">matplotlib</a>.  This
time I'd like to cover some of the more finicky details.  Details that pertain
to making figures look good in your journal publications.</p>
<p>We'll cover three main aspects of plot aesthetics.  First, font size.
Optimising font size is crucial to making your figures look the part in journals.
Second, when the fonts in your plots don't match the fonts in the main body
text, the flow of the document becomes jarring.  We'll talk about how to fix
that.  Third, tick marks.  Usually, figures need to be shrunk down to fit in a
page nicely.  Adjusting the number of tick marks can make your figures look a
lot less busy.  We'll also go over optimising the physical size of your
graphics so that the effect of shrinking your figures down to fit in the page
doesn't undo all the hard work you just put in to make your graphs look good.</p>
<p>To wrap up, I'm going to try package all these touches into a single file.
This should make it easy to create reproducible figures.</p>
<div class="section" id="font-size">
<h2>Font size</h2>
<p>The first thing to notice is that the font size will need some adjust for most
journals.  Usually, printed font size is around <tt class="docutils literal">10pt</tt> or <tt class="docutils literal">11pt</tt>.  Setting
the font size of the various text elements in your plots is, of course, a
matter of personal preference.  That said, I tend to make the font size in my
figures one size smaller than that of the text in the main body of the article.
Your journal's website should tell you what font size they use.</p>
<p>There are three main font elements in a matplotlib figure; the axes labels;
tick labels; and the text inside a legend.  The most common way to adjust these
is to manipulate the <tt class="docutils literal">rcParams</tt> dictionary.  In the following example python
code, we set the font size of each of these elements to <tt class="docutils literal">9pt</tt>.</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
</pre></div>
<p>As long as you remember to do this before saving the figure, you should see the
changes.  I usually leave all the <tt class="docutils literal">rcParams</tt> related foo at the top of my
script, just to keep it all in one place.</p>
</div>
<div class="section" id="typeface">
<h2>Typeface</h2>
<p>Probably the most important issue is the font the is used in the typesetting
of your figure's text elements.  By default, matplotlib does not use the
ubiquitous Computer Modern Roman font.  In fact, by default, it does not even
use <tt class="docutils literal">LaTeX</tt> to typeset the text.  To do so, see the following:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;serif&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Computer Modern Roman&#39;</span><span class="p">]</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
<p>A lot of journals use Computer Modern Roman, but some don't.  Times is a
commonly used font.  Using a nondefault font is a little more tricky and I will
address that later.</p>
</div>
<div class="section" id="adjusting-the-number-of-ticks">
<h2>Adjusting the number of ticks</h2>
<p>When figures get shrunk down to fit inside a column of a journal article, it
might be worth adjusting the number of ticks there are on the y-axis.
Matplotlib tries to be clever and gives you a 'nice-looking' number of ticks,
but sometimes it doesn't cut the mustard.  To fiddle around, you'll need to
play with a <tt class="docutils literal">ticker</tt> object.  We'll use a convenience ticker called
<tt class="docutils literal">MaxNLocator</tt>:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MaxNLocator</span>
<span class="n">my_locator</span> <span class="o">=</span> <span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="c"># Set up axes and plot some awesome science</span>

<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">my_locator</span><span class="p">)</span>
</pre></div>
<p>The number <tt class="docutils literal">6</tt> just says, &quot;give me no more than 6 ticks, and give them to me
at nice locations&quot;.  It doesn't actually say that, I just look at code so long
all day I feel like it starts talking to me.  Coffee helps.</p>
</div>
<div class="section" id="the-figure-size">
<h2>The figure size</h2>
<p>This is probably the most important of all the setting mentioned so far.
Setting the physical figure dimensions appropriately will mean that your graphs
aren't 'shrunk down' to fit into your papers.  This means font sizes will stay
true to their set values.  This is also the most finicky setting.</p>
<p>We will optimise figure dimensions for the specific <tt class="docutils literal">LaTeX</tt> document that you
are editing your paper in.  Presumably you will be using some journal's custom
style file.  We need the width, in points, of where your figure will go.  Add
this to your <tt class="docutils literal">tex</tt> file to force the compiler to show you the text width:</p>
<div class="highlight"><pre><span class="k">\documentclass</span><span class="nb">{</span>some<span class="nb">_</span>journal<span class="nb">}</span>

<span class="k">\usepackage</span><span class="nb">{</span>some<span class="nb">_</span>packages,here<span class="nb">}</span>
<span class="c">% maybe some other preamble goes here</span>

<span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>

<span class="c">% some awesome science goes here</span>

<span class="k">\showthe\textwidth</span>  <span class="c">% &lt;-- this tells you the textwidth</span>

<span class="c">% some more awesome science</span>
<span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</pre></div>
<p>This number will probably be 300--400 pts.  Lets's say 350pt.  The following
python code will convert this number to figure dimensions that look
aesthetically pleasing:</p>
<div class="highlight"><pre><span class="n">WIDTH</span> <span class="o">=</span> <span class="mf">350.0</span>  <span class="c"># the number latex spits out</span>
<span class="n">FACTOR</span> <span class="o">=</span> <span class="mf">0.45</span>  <span class="c"># the fraction of the width you&#39;d like the figure to occupy</span>
<span class="n">fig_width_pt</span>  <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">*</span> <span class="n">FACTOR</span>

<span class="n">inches_per_pt</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">72.27</span>
<span class="n">golden_ratio</span>  <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>  <span class="c"># because it looks good</span>

<span class="n">fig_width_in</span>  <span class="o">=</span> <span class="n">fig_width_pt</span> <span class="o">*</span> <span class="n">inches_per_pt</span>  <span class="c"># figure width in inches</span>
<span class="n">fig_height_in</span> <span class="o">=</span> <span class="n">fig_width_in</span> <span class="o">*</span> <span class="n">golden_ratio</span>   <span class="c"># figure height in inches</span>
<span class="n">fig_dims</span>      <span class="o">=</span> <span class="p">[</span><span class="n">fig_width_in</span><span class="p">,</span> <span class="n">fig_height_in</span><span class="p">]</span> <span class="c"># fig dims as a list</span>
</pre></div>
<p>You can then either set the figure dimensions when creating the figure:</p>
<div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_dims</span><span class="p">)</span>
</pre></div>
<p>Or you can pre compute <tt class="docutils literal">fig_dims</tt> by hand (say it's <tt class="docutils literal">7.3</tt> wide by <tt class="docutils literal">4.2</tt>
high) and set the corresponding entry in the <tt class="docutils literal">matplotlibrc</tt> file:</p>
<div class="highlight"><pre><span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="p">:</span> <span class="mf">7.3</span><span class="p">,</span> <span class="mf">4.2</span>
</pre></div>
<p>Then, when the time comes to include figures into your document, remember to
use the <tt class="docutils literal">FACTOR</tt> variable to have your plots scaled properly:</p>
<div class="highlight"><pre><span class="k">\documentclass</span><span class="nb">{</span>some<span class="nb">_</span>journal<span class="nb">}</span>

<span class="k">\usepackage</span><span class="nb">{</span>some<span class="nb">_</span>packages,here,graphicx<span class="nb">}</span>
<span class="c">% maybe some other preamble goes here</span>

<span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>

<span class="c">% some awesome science goes here</span>

<span class="k">\begin</span><span class="nb">{</span>figure<span class="nb">}</span>
<span class="k">\includegraphics</span><span class="na">[width=0.45\textwidth]</span><span class="nb">{</span>figure.pdf<span class="nb">}</span>  <span class="c">% &lt;-- FACTOR = 0.45</span>
<span class="k">\end</span><span class="nb">{</span>figure<span class="nb">}</span>

<span class="c">% some more awesome science</span>
<span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</pre></div>
<p>Now your figures should look good.  This is all personal preference, though.
Feel free to play around and find something you like.</p>
</div>
<div class="section" id="putting-it-all-together">
<h2>Putting it all together</h2>
<p>Well, those four issues are the ones whose defaults irk me the most, but it's
kind of a pain to type out all that code for each plot I do.  Even still, I
might be writing several papers at once, each containing several plots.
There's a better way to manage this, and it's to use the <tt class="docutils literal">matplotlibrc</tt> file.</p>
<p>As a quick introduction, the keys of the <tt class="docutils literal">rcParams</tt> dictionary correspond to
entries in the <tt class="docutils literal">matplotlibrc</tt> file.  For the issues discussed above, here are
the mappings from the <tt class="docutils literal">rcParams</tt> dictionary to the entry in the
<tt class="docutils literal">matplotlibrc</tt> file:</p>
<div class="highlight"><pre><span class="c"># rcParams dict</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;serif&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Computer Modern Roman&#39;</span><span class="p">]</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">7.3</span><span class="p">,</span> <span class="mf">4.2</span>

<span class="c"># matplotlibrc file</span>
<span class="n">axes</span><span class="o">.</span><span class="n">labelsize</span>  <span class="p">:</span> <span class="mf">9.0</span>  <span class="c"># fontsize of the x any y labels</span>
<span class="n">xtick</span><span class="o">.</span><span class="n">labelsize</span> <span class="p">:</span> <span class="mf">9.0</span>  <span class="c"># fontsize of the tick labels</span>
<span class="n">ytick</span><span class="o">.</span><span class="n">labelsize</span> <span class="p">:</span> <span class="mf">9.0</span>  <span class="c"># fontsize of the tick labels</span>
<span class="n">legend</span><span class="o">.</span><span class="n">fontsize</span> <span class="p">:</span> <span class="mf">9.0</span>
<span class="n">font</span><span class="o">.</span><span class="n">family</span>     <span class="p">:</span> <span class="n">serif</span>
<span class="n">font</span><span class="o">.</span><span class="n">serif</span>      <span class="p">:</span> <span class="n">Computer</span> <span class="n">Modern</span> <span class="n">Roman</span>
<span class="n">text</span><span class="o">.</span><span class="n">usetex</span>     <span class="p">:</span> <span class="bp">True</span>  <span class="c"># use latex for all text handling</span>
<span class="n">figure</span><span class="o">.</span><span class="n">figsize</span>  <span class="p">:</span> <span class="mf">7.3</span><span class="p">,</span> <span class="mf">4.2</span>
</pre></div>
<p>Usually, the <tt class="docutils literal">matplotlibrc</tt> file lives in <tt class="docutils literal"><span class="pre">~/.matplotlib</span></tt>.  If it doesn't,
system-wide defaults are used.  If it does, then that file determines the
defaults to be used for all plots you create.  The downside is that it's likely
the case, especially if you're working on more than one paper, that you'd like
a different set of defaults to apply to each one.</p>
<p>Enter <tt class="docutils literal">rc_file</tt>.  This function takes a path to a file that is treated as a
<tt class="docutils literal">matplotlibrc</tt> file.  Now you can keep your default settings in one place for
each journal.  Moreover, if you submit any new papers to that journal, all your
plots will look the same across multiple papers.  Just copy the matplotlib
defaults, from <a class="reference external" href="http://matplotlib.org/users/customizing.html#matplotlibrc-sample">here</a>, override with your defaults, and then stick the following
at the top of your plotter:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc_file</span>
<span class="n">rc_file</span><span class="p">(</span><span class="s">&#39;/path/to/my/rc/file.rc&#39;</span><span class="p">)</span>  <span class="c"># &lt;-- the file containing your settings</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c"># plot some awesome science</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c"># Make the figure use all available whitespace</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;awesome_science.pdf&#39;</span><span class="p">)</span>
</pre></div>
<p>Notice the use of <tt class="docutils literal">tight_layout</tt>, which makes the figure use all the
available whitespace.</p>
<p>Now all your plots will look the same, every time, and for every journal.  Your
plots are now reproducible.</p>
</div>

    </div>
  </article>
    <hr />
  <ul class="inline-list">
    <li>Filed under:</li>
        <li>python</li>
        <li>matplotlib</li>
        <li>science</li>
      </ul>
        </div>
    </div>
    <!-- End Main Content -->
  </div>
  <!-- End Main Content and Sidebar -->

  <!-- Footer -->
  <footer class="row">
    <div class="large-12 columns">
      <hr />
      <div class="row">
        <div class="large-6 columns">
          <p>&copy; Copyright Damon McDougall 2013</p>
        </div>
      </div>
    </div>
  </footer>
  <script>
  document.write('<script src=' +
  ('__proto__' in {} ? './theme/js/vendor/zepto' : './theme/js/vendor/jquery') +
  '.js><\/script>')
  </script>

  <script src="./theme/js/foundation.min.js"></script>
  <!--
  <script src="js/foundation/foundation.js"></script>
  <script src="js/foundation/foundation.alerts.js"></script>
  <script src="js/foundation/foundation.clearing.js"></script>
  <script src="js/foundation/foundation.cookie.js"></script>
  <script src="js/foundation/foundation.dropdown.js"></script>
  <script src="js/foundation/foundation.forms.js"></script>
  <script src="js/foundation/foundation.joyride.js"></script>
  <script src="js/foundation/foundation.magellan.js"></script>
  <script src="js/foundation/foundation.orbit.js"></script>
  <script src="js/foundation/foundation.placeholder.js"></script>
  <script src="js/foundation/foundation.reveal.js"></script>
  <script src="js/foundation/foundation.section.js"></script>
  <script src="js/foundation/foundation.tooltips.js"></script>
  <script src="js/foundation/foundation.topbar.js"></script>
  -->
  <script>
    $(document).foundation();
  </script>
</body>
</html>